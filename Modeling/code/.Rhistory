# test pearson's correlation for numeric variables used
df <- orig_data %>% subset(select = test.x.vars[test.x.vars %in% numeric.x.var.names])
test.corr <- cor(df)
print(c('predictor correlation matrix', title))
print(test.corr)
}
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- muni_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "region", # for spatial effects
"year_factor", # for time effects
"onset_historicalRange", # other predictors
"onset:latitude", "onset:longitude", "onset:region", # interactions: for spatial effects
"onset:year_factor", # interactions: for time effects
"onset:intensity") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# Reduced model -------------------------------------------------------------------------------------------
test.y.var <- "plant_median"
# , "latitude", "longitude", "intensity", "soy_age", "region", "onset_historicalRange", "year_index"
test.x.vars <- c("onset", "intensity", "year", "region", "latitude", "soy_age")
# note, doing x*y will create x + y + x:y, while x:y doesn't necessarily include x + y
test.spatial.fe.scale <- "none"
test.spatial.auto.model <- "none"
test.crop.intensity <- "none"
test.mask.soy.area <- TRUE
test1 <- do_lm(data = cell_tidy,
y.var = test.y.var,
x.vars = test.x.vars,
spatial.auto.model = test.spatial.auto.model,
crop.intensity = test.crop.intensity,
mask.soy.area = test.mask.soy.area)
test1.adjR2 <- summary(test1)$adj.r.squared
print(test1.adjR2)
# 'Fuller' model -----------------------------------------------------------------------------------------
test.x.vars <- c("onset", "intensity", "year", "region", "latitude", "soy_age")
test2 <- do_lm(data = cell_tidy,
y.var = test.y.var,
x.vars = test.x.vars,
spatial.auto.model = test.spatial.auto.model,
crop.intensity = test.crop.intensity,
mask.soy.area = test.mask.soy.area)
test2.adjR2 <- summary(test2)$adj.r.squared
anova(test1, test2)
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- cell_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", # for spatial effects
"year_index", # for time effects
"soy_age", "onset_historicalRange", # other predictors
"onset:latitude", "onset:longitude", # interactions: for spatial effects
"onset:year_index", # interactions: for time effects
"onset:soy_age", "onset:intensity") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- cell_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "latitude:longitude", # for spatial effects
"year_factor", # for time effects
"soy_age", "onset_historicalRange", # other predictors
"onset:latitude", "onset:longitude", # interactions: for spatial effects
"onset:year_factor", # interactions: for time effects
"onset:soy_age", "onset:intensity") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- cell_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "region", # for spatial effects
"year_index", # for time effects
"soy_age", "onset_historicalRange", # other predictors
"onset:latitude", "onset:longitude", "onset:region", # interactions: for spatial effects
"onset:year_index", # interactions: for time effects
"onset:soy_age", "onset:intensity") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- cell_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "region", # for spatial effects
"year_factor", # for time effects
"soy_age", "onset_historicalRange", # other predictors
"onset:latitude", "onset:longitude", "onset:region", # interactions: for spatial effects
"onset:year_factor", # interactions: for time effects
"onset:soy_age", "onset:intensity") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- cell_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "muni", # for spatial effects
"year_index", # for time effects
"soy_age", "onset_historicalRange", # other predictors
"onset:latitude", "onset:longitude", "onset:muni", # interactions: for spatial effects
"onset:year_index", # interactions: for time effects
"onset:soy_age", "onset:intensity") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- cell_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "Muni_code", # for spatial effects
"year_index", # for time effects
"soy_age", "onset_historicalRange", # other predictors
"onset:latitude", "onset:longitude", "onset:Muni_code", # interactions: for spatial effects
"onset:year_index", # interactions: for time effects
"onset:soy_age", "onset:intensity") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- cell_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "Muni_code", # for spatial effects
"year_index", # for time effects
"soy_age", "onset_historicalRange", # other predictors
"onset:latitude", "onset:longitude", "onset:Muni_code", # interactions: for spatial effects
"onset:year_index", # interactions: for time effects
"onset:soy_age", "onset:intensity") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- cell_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "Muni_code_factor", # for spatial effects
"year_index", # for time effects
"soy_age", "onset_historicalRange", # other predictors
"onset:latitude", "onset:longitude", "onset:Muni_code_factor", # interactions: for spatial effects
"onset:year_index", # interactions: for time effects
"onset:soy_age", "onset:intensity") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- cell_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "Muni_code_factor", # for spatial effects
"year_factor", # for time effects
"soy_age", "onset_historicalRange", # other predictors
"onset:latitude", "onset:longitude", "onset:Muni_code_factor", # interactions: for spatial effects
"onset:year_factor", # interactions: for time effects
"onset:soy_age", "onset:intensity") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- CARpoly_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "latitude:longitude", # for spatial effects
"year_index", # for time effects
"onset_historicalRange", "poly_area_km2", # other predictors
"onset:latitude", "onset:longitude",  # interactions: for spatial effects
"onset:year_index", # interactions: for time effects
"onset:intensity", "onset:poly_area_km2") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- CARpoly_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "latitude:longitude", # for spatial effects
"year_factor", # for time effects
"onset_historicalRange", "poly_area_km2", # other predictors
"onset:latitude", "onset:longitude",  # interactions: for spatial effects
"onset:year_factor", # interactions: for time effects
"onset:intensity", "onset:poly_area_km2") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- CARpoly_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "region", # for spatial effects
"year_index", # for time effects
"onset_historicalRange", "poly_area_km2", # other predictors
"onset:latitude", "onset:longitude",  "onset:region", # interactions: for spatial effects
"onset:year_index", # interactions: for time effects
"onset:intensity", "onset:poly_area_km2") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- CARpoly_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "region", # for spatial effects
"year_factor", # for time effects
"onset_historicalRange", "poly_area_km2", # other predictors
"onset:latitude", "onset:longitude",  "onset:region", # interactions: for spatial effects
"onset:year_factor", # interactions: for time effects
"onset:intensity", "onset:poly_area_km2") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- CARpoly_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "Muni_code_factor", # for spatial effects
"year_index", # for time effects
"onset_historicalRange", "poly_area_km2", # other predictors
"onset:latitude", "onset:longitude",  "onset:Muni_code_factor", # interactions: for spatial effects
"onset:year_index", # interactions: for time effects
"onset:intensity", "onset:poly_area_km2") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- CARpoly_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "Muni_code_factor", # for spatial effects
"year_factor", # for time effects
"onset_historicalRange", "poly_area_km2", # other predictors
"onset:latitude", "onset:longitude",  "onset:Muni_code_factor", # interactions: for spatial effects
"onset:year_factor", # interactions: for time effects
"onset:intensity", "onset:poly_area_km2") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- muni_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "latitude:longitude", # for spatial effects
"year_index", # for time effects
"onset_historicalRange",  # other predictors
"onset:latitude", "onset:longitude", # interactions: for spatial effects
"onset:year_index", # interactions: for time effects
"onset:intensity") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- muni_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "latitude:longitude", # for spatial effects
"year_factor", # for time effects
"onset_historicalRange",  # other predictors
"onset:latitude", "onset:longitude", # interactions: for spatial effects
"onset:year_factor", # interactions: for time effects
"onset:intensity") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- muni_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "region", # for spatial effects
"year_index", # for time effects
"onset_historicalRange",  # other predictors
"onset:latitude", "onset:longitude", "onset:region", # interactions: for spatial effects
"onset:year_index", # interactions: for time effects
"onset:intensity") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
# remove variables
rm(data)
rm(initial.predictors)
rm(y.var)
rm(spatial.auto.model)
rm(new.predictors)
rm(crop.intensity)
rm(mask.soy.area)
# test produce_model_stepwise
data <- muni_tidy
initial.predictors <- c("onset", "intensity")
y.var <- "plant_median"
spatial.auto.model <- "none"
new.predictors <- c("latitude", "longitude", "region", # for spatial effects
"year_factor", # for time effects
"onset_historicalRange",  # other predictors
"onset:latitude", "onset:longitude", "onset:region", # interactions: for spatial effects
"onset:year_factor", # interactions: for time effects
"onset:intensity") # interactions: other predictors
crop.intensity <- "none"
mask.soy.area <- TRUE
model <- produce_model_stepwise(data, initial.predictors, y.var, spatial.auto.model,
new.predictors, crop.intensity, mask.soy.area, 6)
evaluate_model(model$final_model, model$final_predictors, data, "output from produce_model_stepwise")
