onset_results <- data.frame() # to save which grid offsets give a significant difference in onset coef between median and percentile plant
grid_index = 0
for (lat_offset in seq(0, 0.25, by = 0.25)) { # 0 to 1.5
for (lon_offset in seq(0, 0.25, by = 0.25)) { # 0 to 1.5
grid_index = grid_index + 1 # to keep track for plotting
# run OLS for median, percentile plants
median_output <- run_OLS(full_data = cell_sf_tidy,
predictors = c("onset", "intensity",
"region", "lat", "lon", # for spatial effects: lat, lon, region, Muni_code
"year_index" # for time effects
),
y.var = "plant", plant_stat = "median",
grid_size = grid_size,
lat_offset = lat_offset, lon_offset = lon_offset, agg_scheme = agg_scheme,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2007,
do_elim_year = do_elim_year)
percentile95_output <- run_OLS(full_data = cell_sf_tidy,
predictors = c("onset", "intensity",
"region", "lat", "lon", # for spatial effects: lat, lon, region, Muni_code
"year_index" # for time effects
),
y.var = "plant", plant_stat = "percentile95",
grid_size = grid_size,
lat_offset = lat_offset, lon_offset = lon_offset, agg_scheme = agg_scheme,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2007,
do_elim_year = do_elim_year)
percentile5_output <- run_OLS(full_data = cell_sf_tidy,
predictors = c("onset", "intensity",
"region", "lat", "lon", # for spatial effects: lat, lon, region, Muni_code
"year_index" # for time effects
),
y.var = "plant", plant_stat = "percentile5",
grid_size = grid_size,
lat_offset = lat_offset, lon_offset = lon_offset, agg_scheme = agg_scheme,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2007,
do_elim_year = do_elim_year)
# get onset coefficients and see if statistically different
output <- data.frame(onset_coef = c(median_output$onset_coef,
percentile95_output$onset_coef, percentile5_output$onset_coef),
onset_stderr = c(median_output$onset_std_error,
percentile95_output$onset_std_error, percentile5_output$onset_std_error),
intensity_coef = c(median_output$intensity_coef,
percentile95_output$intensity_coef, percentile5_output$intensity_coef),
intensity_stderr = c(median_output$intensity_std_error,
percentile95_output$intensity_std_error,
percentile5_output$intensity_std_error),
lat_coef = c(median_output$lat_coef,
percentile95_output$lat_coef, percentile5_output$lat_coef),
lat_stderr = c(median_output$lat_std_error,
percentile95_output$lat_std_error,
percentile5_output$lat_std_error),
year_coef = c(median_output$year_coef,
percentile95_output$year_coef, percentile5_output$year_coef),
year_stderr = c(median_output$year_std_error,
percentile95_output$year_std_error,
percentile5_output$year_std_error),
plant_stat_type = c("median", "percentile95", "percentile5"),
grid = c(grid_index, grid_index, grid_index))
onset_results <- rbind(onset_results, output)
}
}
onset_results
output
run_OLS <- function(full_data, predictors, y.var, plant_stat,
grid_size, lat_offset, lon_offset, agg_scheme,
plot_samples, plot_model_evals, year_oi, do_elim_year) {
# get sampled data
full_data <- full_data[full_data$plant_stat_type == plant_stat,]
sampled_data <- get_sampled_data(full_data = full_data, plant_stat = plant_stat, grid_size = grid_size,
lat_offset = lat_offset, lon_offset = lon_offset, agg_scheme = agg_scheme,
plot_samples = plot_samples, year_oi = year_oi)
# map of the input data used (for specific year and intensity)
if (plot_samples) {
print(plot_cell_onset(year_oi, sampled_data))
print(plot_cell_plant(year_oi, sampled_data, "DC"))
}
# define the formula
formula.string <- paste(y.var, paste(predictors, collapse = " + "), sep = " ~ ")
f <- as.formula(formula.string)
# do the model
model = lm(f, data=sampled_data)
sampled_data$residuals <- residuals(model)
sampled_data$fitted.values <- fitted.values(model)
# map of residuals
if (plot_model_evals) {print(plot_cell_residuals(year_oi, sampled_data, "DC"))}
# evaluation
# 1. coefficients and their p values
coefficients <- model$coefficients
onset_coef <- coefficients["onset"]
intensity_coef <- coefficients["intensitySC"]
lat_coef <- coefficients["lat"]
year_coef <- coefficients["year_index"]
p_vals <- summary(model)$coefficients[, ncol(summary(model)$coefficients)]
onset_pval <- p_vals["onset"]
intensity_pval <- p_vals["intensitySC"]
#lat_pval <- p_vals["lat"]
std_errors <- summary(model)$coefficients[,2]
onset_std_error <- std_errors["onset"]
intensity_std_error <- std_errors["intensitySC"]
lat_std_error <- std_errors["lat"]
year_std_error <- std_errors["year_index"]
# 2. percent data used
percent_data_used <- 100*nrow(sampled_data)/nrow(full_data)
# 3. R2
SST <- sum((sampled_data$plant - mean(sampled_data$plant))^2)
SSE <- sum((sampled_data$residuals - mean(sampled_data$residuals))^2)
R2 <- 1 - SSE/SST
# 4. exogeneity plots (residual vs predictors)
if (plot_model_evals) {
plot(sampled_data$onset, sampled_data$residuals, main = "onset vs residual (exogeneity)")
#plot(sampled_data$lat, sampled_data$residuals, main = "latitude vs residual (exogeneity)")
plot(sampled_data$year, sampled_data$residuals, main = "year vs residual (exogeneity)")
abline(h = 0)
}
# 5. spatial autocorrelation
# need 'one layer': one year, one intensity, set up weights
to_autocorrelation <- sampled_data[sampled_data$year == year_oi & sampled_data$intensity == "DC", ]
to_autocorrelation_sp <- as(to_autocorrelation, "Spatial")
st_geometry(to_autocorrelation) <- NULL # turn to_autocorrelation into data frame
centroids <- coordinates(to_autocorrelation_sp)
to_autocorrelation_points <- SpatialPointsDataFrame(coords = centroids, data = to_autocorrelation)
nb<-knn2nb(knearneigh(to_autocorrelation_points))
lw <- nb2listw(nb, zero.policy = TRUE)
# calculate spatial autocorrelation
moran_residual <- moran.mc(to_autocorrelation_points$residuals, lw, 500, zero.policy = TRUE)
moran_onset <- moran.mc(to_autocorrelation_points$onset, lw, 500, zero.policy = TRUE)
moran_plant <- moran.mc(to_autocorrelation_points$plant, lw, 500, zero.policy = TRUE)
residual_moran <- moran_residual$statistic
residual_moran_pval <- moran_residual$p.value
onset_moran <- moran_onset$statistic
onset_moran_pval <- moran_onset$p.value
plant_moran <- moran_plant$statistic
plant_moran_pval <- moran_plant$p.value
# 6. residual plots (homoscedasticity, normality of error, residual-fitted value correlation)
if (plot_model_evals) {
test_plots(model, paste("grid size", grid_size, "lat offset", lat_offset,
"lon_offset", lon_offset, "aggregated", agg_scheme))
plot(sampled_data$plant, sampled_data$fitted.values,
main = "fitted value vs actual value of plant", ylab = "fitted.values")
abline(h = mean(sampled_data$fitted.values), col = "blue")
abline(v = mean(sampled_data$plant), col = "blue")
abline(0,1, col = "gray", lwd = 3)
}
# 7. multicollinearity: look at max absolute correlation between predictors
predictors <- sampled_data[,c("onset", "year")]
st_geometry(predictors) <- NULL
correlations <- cor(predictors)
diag(correlations) <- 0 # place 1 with 0 on diagonal
highest_predictor_correlation <- max(abs(correlations))
# 8. predictive ability, when eliminate one year
if (do_elim_year) { # set do_elim_year to FALSE if using year as fixed effect
prediction_results_elimyear <- data.frame()
for (year in 2004:2014) {
result <- run_model_for_prediction_elimyear(sampled_data, year, TRUE, f)
prediction_results_elimyear <- rbind(prediction_results_elimyear, result)
}
names(prediction_results_elimyear) <- names(result)
if (plot_model_evals) {
plot(prediction_results_elimyear$eliminated_year, prediction_results_elimyear$RMSE,
ylab = "RMSE", xlab = "eliminated year", ylim = c(5, 25), type = "l",
main = "Prediction RMSE, spatial sampling")
# plot(prediction_results_elimyear$eliminated_year, prediction_results_elimyear$RMSE_improvement,
#      ylab = "RMSE", xlab = "eliminated year", ylim = c(0, 10), type = "l",
#      main = "Prediction RMSE improvement over intercept, spatial sampling")
# plot(prediction_results_elimyear$eliminated_year, prediction_results_elimyear$onset, type = "l", col = "red",
#      ylab = "coef or R2", xlab = "eliminated year", ylim = c(0.1, 0.7),
#      main = "Prediction onset and R2, spatial sampling")
# lines(prediction_results_elimyear$eliminated_year, prediction_results_elimyear$R2, col = "blue")
# legend(2004, 0.65, legend = c("onset coef", "R2"), col = c("red", "blue"), lty= c(1,1))
}
}
# 9. predictive ability, location cross validation
prediction_results_elimlocation <- run_model_for_prediction_elimlocation(full_data = sampled_data,
formula = f,
year_for_location = 2004, year_oi = 2011,
plot_model_evals = plot_model_evals)
if (do_elim_year) {
output_list <- list(onset_coef = onset_coef,
intensity_coef = intensity_coef,
lat_coef = lat_coef,
year_coef = year_coef,
onset_pval = onset_pval,
intensity_pval = intensity_pval,
onset_std_error = onset_std_error,
intensity_std_error = intensity_std_error,
lat_std_error = lat_std_error,
year_std_error = year_std_error,
#lat_pval = lat_pval,
percent_data_used = percent_data_used,
R2 = R2,
residual_moran = residual_moran,
residual_moran_pval = residual_moran_pval,
onset_moran = onset_moran,
onset_moran_pval = onset_moran_pval,
plant_moran = plant_moran,
plant_moran_pval = plant_moran_pval,
highest_predictor_correlation = highest_predictor_correlation,
prediction_results_elimyear = prediction_results_elimyear,
prediction_results_elimlocation = prediction_results_elimlocation
)
}
if (!do_elim_year) {
output_list <- list(onset_coef = onset_coef,
intensity_coef = intensity_coef,
lat_coef = lat_coef,
year_coef = year_coef,
onset_pval = onset_pval,
intensity_pval = intensity_pval,
onset_std_error = onset_std_error,
intensity_std_error = intensity_std_error,
lat_std_error = lat_std_error,
year_std_error = year_std_error,
#lat_pval = lat_pval,
percent_data_used = percent_data_used,
R2 = R2,
residual_moran = residual_moran,
residual_moran_pval = residual_moran_pval,
onset_moran = onset_moran,
onset_moran_pval = onset_moran_pval,
plant_moran = plant_moran,
plant_moran_pval = plant_moran_pval,
highest_predictor_correlation = highest_predictor_correlation,
prediction_results_elimlocation = prediction_results_elimlocation
)
}
return(output_list)
}
# run one set of spatial sampling/predictor set
model_output <- run_OLS(full_data = cell_sf_tidy,
predictors = c("onset", "intensity",
"lat", "lon", # for spatial effects
"year_index" # for time effects
#"onset:lat", "onset:lon", # interactions: for spatial effects
#"onset:year_factor", # interactions: for time effects
#"onset:intensity" # interactions: for intensity effects
),
y.var = "plant", plant_stat = "median",
grid_size = 1.5, lat_offset = 0, lon_offset = 0, agg_scheme = FALSE,
plot_samples = TRUE, plot_model_evals = TRUE,
year_oi = 2012, do_elim_year = FALSE)
print(model_output)
# ggplot(data = cell_sf_tidy, #[cell_sf_tidy$plant_stat_type != "percentile5",]
#        aes(x = onset, y = plant, col = plant_stat_type)) +
#   geom_point(alpha = 0.3) +
#   geom_smooth(aes(group = plant_stat_type), color = "black", size = 1, method = "lm") +
#   geom_abline(intercept = 0, slope = 1) +
#   facet_wrap( ~ year_factor) +
#   theme_bw()
# see if onset coef is statistically different for the different plant_stat_types
agg_scheme = FALSE
do_elim_year = FALSE
onset_results <- data.frame() # to save which grid offsets give a significant difference in onset coef between median and percentile plant
grid_index = 0
for (lat_offset in seq(0, 0.25, by = 0.25)) { # 0 to 1.5
for (lon_offset in seq(0, 0.25, by = 0.25)) { # 0 to 1.5
grid_index = grid_index + 1 # to keep track for plotting
# run OLS for median, percentile plants
median_output <- run_OLS(full_data = cell_sf_tidy,
predictors = c("onset", "intensity",
"region", "lat", "lon", # for spatial effects: lat, lon, region, Muni_code
"year_index" # for time effects
),
y.var = "plant", plant_stat = "median",
grid_size = grid_size,
lat_offset = lat_offset, lon_offset = lon_offset, agg_scheme = agg_scheme,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2007,
do_elim_year = do_elim_year)
percentile95_output <- run_OLS(full_data = cell_sf_tidy,
predictors = c("onset", "intensity",
"region", "lat", "lon", # for spatial effects: lat, lon, region, Muni_code
"year_index" # for time effects
),
y.var = "plant", plant_stat = "percentile95",
grid_size = grid_size,
lat_offset = lat_offset, lon_offset = lon_offset, agg_scheme = agg_scheme,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2007,
do_elim_year = do_elim_year)
percentile5_output <- run_OLS(full_data = cell_sf_tidy,
predictors = c("onset", "intensity",
"region", "lat", "lon", # for spatial effects: lat, lon, region, Muni_code
"year_index" # for time effects
),
y.var = "plant", plant_stat = "percentile5",
grid_size = grid_size,
lat_offset = lat_offset, lon_offset = lon_offset, agg_scheme = agg_scheme,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2007,
do_elim_year = do_elim_year)
# get onset coefficients and see if statistically different
output <- data.frame(onset_coef = c(median_output$onset_coef,
percentile95_output$onset_coef, percentile5_output$onset_coef),
onset_stderr = c(median_output$onset_std_error,
percentile95_output$onset_std_error, percentile5_output$onset_std_error),
intensity_coef = c(median_output$intensity_coef,
percentile95_output$intensity_coef, percentile5_output$intensity_coef),
intensity_stderr = c(median_output$intensity_std_error,
percentile95_output$intensity_std_error,
percentile5_output$intensity_std_error),
lat_coef = c(median_output$lat_coef,
percentile95_output$lat_coef, percentile5_output$lat_coef),
lat_stderr = c(median_output$lat_std_error,
percentile95_output$lat_std_error,
percentile5_output$lat_std_error),
year_coef = c(median_output$year_coef,
percentile95_output$year_coef, percentile5_output$year_coef),
year_stderr = c(median_output$year_std_error,
percentile95_output$year_std_error,
percentile5_output$year_std_error),
plant_stat_type = c("median", "percentile95", "percentile5"),
grid = c(grid_index, grid_index, grid_index))
onset_results <- rbind(onset_results, output)
}
}
names(onset_results) <- c('onset_coef', 'onset_stderr', 'intensity_coef', 'intensity_stderr',
'lat_coef', 'lat_stderr', 'year_coef', 'year_stderr',
'plant_stat_type', 'grid_index')
ggplot(onset_results, aes(x = grid_index, y = onset_coef, col = plant_stat_type)) +
geom_point(size = 3) +
geom_line() +
geom_errorbar(aes(ymin = onset_coef - onset_stderr, ymax = onset_coef + onset_stderr)) +
theme_bw()
ggplot(onset_results, aes(x = grid_index, y = intensity_coef, col = plant_stat_type)) +
geom_point(size = 3) +
geom_line() +
geom_errorbar(aes(ymin = intensity_coef - intensity_stderr, ymax = intensity_coef + intensity_stderr)) +
theme_bw()
ggplot(onset_results, aes(x = grid_index, y = lat_coef, col = plant_stat_type)) +
geom_point(size = 3) +
geom_line() +
geom_errorbar(aes(ymin = lat_coef - lat_stderr, ymax = lat_coef + lat_stderr)) +
theme_bw()
ggplot(onset_results, aes(x = grid_index, y = year_coef, col = plant_stat_type)) +
geom_point(size = 3) +
geom_line() +
geom_errorbar(aes(ymin = year_coef - year_stderr, ymax = year_coef + year_stderr)) +
theme_bw()
# ggplot(data = cell_sf_tidy, #[cell_sf_tidy$plant_stat_type != "percentile5",]
#        aes(x = onset, y = plant, col = plant_stat_type)) +
#   geom_point(alpha = 0.3) +
#   geom_smooth(aes(group = plant_stat_type), color = "black", size = 1, method = "lm") +
#   geom_abline(intercept = 0, slope = 1) +
#   facet_wrap( ~ year_factor) +
#   theme_bw()
# see if onset coef is statistically different for the different plant_stat_types
agg_scheme = FALSE
do_elim_year = FALSE
onset_results <- data.frame() # to save which grid offsets give a significant difference in onset coef between median and percentile plant
grid_index = 0
for (lat_offset in seq(0, 1.5, by = 0.25)) { # 0 to 1.5
for (lon_offset in seq(0, 1.5, by = 0.25)) { # 0 to 1.5
grid_index = grid_index + 1 # to keep track for plotting
# run OLS for median, percentile plants
median_output <- run_OLS(full_data = cell_sf_tidy,
predictors = c("onset", "intensity",
"region", "lat", "lon", # for spatial effects: lat, lon, region, Muni_code
"year_index" # for time effects
),
y.var = "plant", plant_stat = "median",
grid_size = grid_size,
lat_offset = lat_offset, lon_offset = lon_offset, agg_scheme = agg_scheme,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2007,
do_elim_year = do_elim_year)
percentile95_output <- run_OLS(full_data = cell_sf_tidy,
predictors = c("onset", "intensity",
"region", "lat", "lon", # for spatial effects: lat, lon, region, Muni_code
"year_index" # for time effects
),
y.var = "plant", plant_stat = "percentile95",
grid_size = grid_size,
lat_offset = lat_offset, lon_offset = lon_offset, agg_scheme = agg_scheme,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2007,
do_elim_year = do_elim_year)
percentile5_output <- run_OLS(full_data = cell_sf_tidy,
predictors = c("onset", "intensity",
"region", "lat", "lon", # for spatial effects: lat, lon, region, Muni_code
"year_index" # for time effects
),
y.var = "plant", plant_stat = "percentile5",
grid_size = grid_size,
lat_offset = lat_offset, lon_offset = lon_offset, agg_scheme = agg_scheme,
plot_samples = FALSE, plot_model_evals = FALSE,
year_oi = 2007,
do_elim_year = do_elim_year)
# get onset coefficients and see if statistically different
output <- data.frame(onset_coef = c(median_output$onset_coef,
percentile95_output$onset_coef, percentile5_output$onset_coef),
onset_stderr = c(median_output$onset_std_error,
percentile95_output$onset_std_error, percentile5_output$onset_std_error),
intensity_coef = c(median_output$intensity_coef,
percentile95_output$intensity_coef, percentile5_output$intensity_coef),
intensity_stderr = c(median_output$intensity_std_error,
percentile95_output$intensity_std_error,
percentile5_output$intensity_std_error),
lat_coef = c(median_output$lat_coef,
percentile95_output$lat_coef, percentile5_output$lat_coef),
lat_stderr = c(median_output$lat_std_error,
percentile95_output$lat_std_error,
percentile5_output$lat_std_error),
year_coef = c(median_output$year_coef,
percentile95_output$year_coef, percentile5_output$year_coef),
year_stderr = c(median_output$year_std_error,
percentile95_output$year_std_error,
percentile5_output$year_std_error),
plant_stat_type = c("median", "percentile95", "percentile5"),
grid = c(grid_index, grid_index, grid_index))
onset_results <- rbind(onset_results, output)
}
}
names(onset_results) <- c('onset_coef', 'onset_stderr', 'intensity_coef', 'intensity_stderr',
'lat_coef', 'lat_stderr', 'year_coef', 'year_stderr',
'plant_stat_type', 'grid_index')
ggplot(onset_results, aes(x = grid_index, y = onset_coef, col = plant_stat_type)) +
geom_point(size = 3) +
geom_line() +
geom_errorbar(aes(ymin = onset_coef - onset_stderr, ymax = onset_coef + onset_stderr)) +
theme_bw()
ggplot(onset_results, aes(x = grid_index, y = intensity_coef, col = plant_stat_type)) +
geom_point(size = 3) +
geom_line() +
geom_errorbar(aes(ymin = intensity_coef - intensity_stderr, ymax = intensity_coef + intensity_stderr)) +
theme_bw()
ggplot(onset_results, aes(x = grid_index, y = lat_coef, col = plant_stat_type)) +
geom_point(size = 3) +
geom_line() +
geom_errorbar(aes(ymin = lat_coef - lat_stderr, ymax = lat_coef + lat_stderr)) +
theme_bw()
ggplot(onset_results, aes(x = grid_index, y = year_coef, col = plant_stat_type)) +
geom_point(size = 3) +
geom_line() +
geom_errorbar(aes(ymin = year_coef - year_stderr, ymax = year_coef + year_stderr)) +
theme_bw()
ggplot(data = cell_sf_tidy[cell_sf_tidy$plant_stat_type != "median",],
aes(x = onset, y = plant, col = plant_stat_type)) +
geom_point(alpha = 0.3) +
geom_smooth(aes(group = plant_stat_type), color = "black", size = 1, method = "lm") +
geom_abline(intercept = 0, slope = 1) +
facet_wrap( ~ year_factor) +
theme_bw()
ggplot(data = cell_sf_tidy[cell_sf_tidy$plant_stat_type != "median",],
aes(x = onset, y = plant, col = plant_stat_type)) +
geom_point(alpha = 0.3) +
geom_smooth(aes(group = plant_stat_type), color = "black", size = 1, method = "lm") +
geom_abline(intercept = 0, slope = 1) +
facet_wrap(intensity ~ year_factor) +
theme_bw()
ggplot(data = cell_sf_tidy[cell_sf_tidy$plant_stat_type != "median",],
aes(x = onset, y = plant, col = plant_stat_type)) +
geom_point(alpha = 0.3) +
geom_smooth(aes(group = plant_stat_type), color = "black", size = 1, method = "lm") +
geom_abline(intercept = 0, slope = 1) +
facet_grid(intensity ~ year_factor) +
theme_bw()
ggplot(data = cell_sf_tidy[cell_sf_tidy$plant_stat_type != "median",],
aes(x = onset, y = plant, col = plant_stat_type, size = intensity)) +
geom_point(alpha = 0.3) +
geom_smooth(aes(group = plant_stat_type), color = "black", size = 1, method = "lm") +
geom_abline(intercept = 0, slope = 1) +
facet_grid( ~ year_factor) +
theme_bw()
ggplot(data = cell_sf_tidy[cell_sf_tidy$plant_stat_type != "median",],
aes(x = onset, y = plant, col = plant_stat_type, shape = intensity)) +
geom_point(alpha = 0.3) +
geom_smooth(aes(group = plant_stat_type), color = "black", size = 1, method = "lm") +
geom_abline(intercept = 0, slope = 1) +
facet_wrap( ~ year_factor) +
theme_bw()
ggplot(data = cell_sf_tidy[cell_sf_tidy$plant_stat_type != "median",],
aes(x = onset, y = plant, col = plant_stat_type, alpha = intensity)) +
geom_point(alpha = 0.3) +
geom_smooth(aes(group = plant_stat_type), color = "black", size = 1, method = "lm") +
geom_abline(intercept = 0, slope = 1) +
facet_wrap( ~ year_factor) +
theme_bw()
ggplot(data = cell_sf_tidy[cell_sf_tidy$plant_stat_type != "median" & cell_sf_tidy$intensity == "SC",],
aes(x = onset, y = plant, col = plant_stat_type, alpha = intensity)) +
geom_point(alpha = 0.3) +
geom_smooth(aes(group = plant_stat_type), color = "black", size = 1, method = "lm") +
geom_abline(intercept = 0, slope = 1) +
facet_wrap( ~ year_factor) +
ggtitle('SC') +
theme_bw()
ggplot(data = cell_sf_tidy[cell_sf_tidy$plant_stat_type != "median" & cell_sf_tidy$intensity == "DC",],
aes(x = onset, y = plant, col = plant_stat_type, alpha = intensity)) +
geom_point(alpha = 0.3) +
geom_smooth(aes(group = plant_stat_type), color = "black", size = 1, method = "lm") +
geom_abline(intercept = 0, slope = 1) +
facet_wrap( ~ year_factor) +
ggtitle('DC') +
theme_bw()
ggplot(data = cell_sf_tidy[cell_sf_tidy$plant_stat_type != "median" & cell_sf_tidy$intensity == "SC",],
aes(x = onset, y = plant, col = plant_stat_type)) +
geom_point(alpha = 0.3) +
geom_smooth(aes(group = plant_stat_type), color = "black", size = 1, method = "lm") +
geom_abline(intercept = 0, slope = 1) +
facet_wrap( ~ year_factor) +
ggtitle('SC') +
theme_bw()
ggplot(data = cell_sf_tidy[cell_sf_tidy$plant_stat_type != "median" & cell_sf_tidy$intensity == "DC",],
aes(x = onset, y = plant, col = plant_stat_type)) +
geom_point(alpha = 0.3) +
geom_smooth(aes(group = plant_stat_type), color = "black", size = 1, method = "lm") +
geom_abline(intercept = 0, slope = 1) +
facet_wrap( ~ year_factor) +
ggtitle('DC') +
theme_bw()
